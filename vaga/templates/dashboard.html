{% extends 'base.html' %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<h1 class="text-center mb-4">Mapa de Vagas</h1>

<!-- Grade de Vagas -->
<div id="mapa-vagas-container"
     style="display: grid; gap: 8px; justify-content: center; margin-top: 40px;">
</div>

<!-- Legenda com Totais -->
<div class="mt-5 text-center" style="font-size: 1.25rem; font-weight: 500;">
    <span style="color: #28a745;"><i class="bi bi-square-fill"></i> Vagas Livres:</span> <span id="total-livres"></span>
    &nbsp;&nbsp;&nbsp;
    <span style="color: #dc3545;"><i class="bi bi-square-fill"></i> Vagas Ocupadas:</span> <span id="total-ocupadas"></span>
    &nbsp;&nbsp;&nbsp;
    <span><strong>Total:</strong> <span id="total-geral"></span></span>
</div>

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<!-- Script para gerar a grade -->
<script>
  const vagas = {{ vagas_status|safe }};
  const colunas = 10;

  const container = document.getElementById('mapa-vagas-container');
  container.style.gridTemplateColumns = `repeat(${colunas}, 1fr)`;

  let livres = 0;
  let ocupadas = 0;

  vagas.forEach(v => {
    const div = document.createElement('div');
    div.style.width = '60px';
    div.style.height = '60px';
    div.style.borderRadius = '4px';
    div.style.display = 'flex';
    div.style.alignItems = 'center';
    div.style.justifyContent = 'center';
    div.style.fontWeight = 'bold';
    div.style.color = 'white';
    div.style.fontSize = '18px';
    div.style.cursor = 'default';

    if (v.status === 'livre') {
      div.style.backgroundColor = '#28a745';
      livres++;
    } else {
      div.style.backgroundColor = '#dc3545';
      ocupadas++;
    }

    div.innerText = v.numero;
    div.title = `Vaga ${v.numero} â€” ${v.status}`;
    container.appendChild(div);
  });

  // Atualizar totais na legenda
  document.getElementById('total-livres').textContent = livres;
  document.getElementById('total-ocupadas').textContent = ocupadas;
  document.getElementById('total-geral').textContent = vagas.length;
</script>
{% endblock %}
